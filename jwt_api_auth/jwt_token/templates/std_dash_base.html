{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>student dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="{% static 'css/student_dashboard.css'%}">
</head>
<body>
    {% block nav %}
      <nav class="navbar navbar-expand-lg bg-primary">
  <div class="container-fluid">
    <a class="navbar-brand text-teal-500 font-bold" href="#">Student</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="#">Fees</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Academics</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Photo</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Time</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Cource
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">x</a></li>
            <li><a class="dropdown-item" href="#">y</a></li>
            <li><a class="dropdown-item" href="#">y</a></li>
          </ul>
        </li>
        <button onclick="logout()">Logout</button>
      </ul>
    </div>
  </div>
</nav>
    {% endblock nav %}
    
    {% block body %}
     <div id="dashboard" style="display: none;">
    <p>ðŸŽ‰ Welcome, student!</p>
  </div>
  <div class="form-container">
    <h2>Student Registration Form</h2>
    <form id="studentForm" method="POST" action="/submit-form/">
      <div class="form-group">
        <label for="name">Full Name:</label>
        <input type="text" id="name" name="name" required>
      </div>
      
      <div class="form-group">
        <label for="age">Age:</label>
        <input type="number" id="age" name="age" min="1" required>
      </div>
      
      <div class="form-group">
        <label for="class">Class:</label>
        <input type="text" id="class" name="class" required>
      </div>
      
      <div class="form-group">
        <label for="address">Address:</label>
        <textarea id="address" name="address" rows="3" required></textarea>
      </div>
      
      <div class="form-group">
        <label for="phone">Phone Number:</label>
        <input type="tel" id="phone" name="phone" pattern="[0-9]{10}" required>
      </div>

      <div class="form-group">
        <label for="email">Email Address:</label>
        <input type="email" id="email" name="email">
      </div>

      <button type="submit">Register Student</button>
    </form>
  </div>
    
    {% endblock body %}
</body>
 <script src="{% static 'js/student_dashboard.js' %}"></script>
 <script>
document.getElementById('studentForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  const formData = new FormData(this);

  const data = {
    name: formData.get('name'),
    age: formData.get('age'),
    student_class: formData.get('class'),
    address: formData.get('address'),
    phone: formData.get('phone'),
    email: formData.get('email'),
  };

  const response = await fetch('/api/register-student/', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-CSRFToken': getCookie('csrftoken')  // Include CSRF for security
    },
    body: JSON.stringify(data)
  });

  const result = await response.json();
  alert(result.msg || "Failed to register");
});

function getCookie(name) {
  let cookieValue = null;
  if (document.cookie && document.cookie !== '') {
    const cookies = document.cookie.split(';');
    for (let i = 0; i < cookies.length; i++) {
      const cookie = cookies[i].trim();
      if (cookie.substring(0, name.length + 1) === (name + '=')) {
        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
        break;
      }
    }
  }
  return cookieValue;
}
</script>

</html>